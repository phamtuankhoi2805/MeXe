<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dịch vụ pin xe máy điện VinFast</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/trang-chu.css}" href="/css/trang-chu.css">
    <link rel="stylesheet" th:href="@{/css/dich-vu-pin.css}" href="/css/dich-vu-pin.css">
</head>
<body>

<div th:replace="~{fragments/dieu-huong :: thanhDieuHuong}"></div>

<main class="battery-service-page">
    <section class="vf-container page-hero" data-animate>
        <div class="hero-text">
            <p class="eyebrow">Dịch vụ pin VinFast</p>
            <h1>Thuê pin linh hoạt, an tâm di chuyển khắp Việt Nam</h1>
            <p>Giải pháp sở hữu xe máy điện tối ưu chi phí với hệ sinh thái hơn 150.000 điểm đổi/sạc pin,
                đội ngũ kỹ thuật phản hồi trong 30 phút và chính sách bảo hành trọn vòng đời.</p>
            <div class="hero-actions">
                <button class="vf-btn vf-btn--primary">Đăng ký gói pin</button>
                <a class="vf-btn vf-btn--ghost" href="#goi-pin">So sánh gói</a>
            </div>
            <dl class="hero-stats">
                <div>
                    <dt>150.000+</dt>
                    <dd>Điểm sạc & đổi pin toàn quốc</dd>
                </div>
                <div>
                    <dt>30 phút</dt>
                    <dd>Hỗ trợ kỹ thuật tối đa</dd>
                </div>
                <div>
                    <dt>262 km</dt>
                    <dd>Quãng đường với pin LFP mới</dd>
                </div>
                <div>
                    <dt>24/7</dt>
                    <dd>Giám sát pin qua ứng dụng</dd>
                </div>
            </dl>
        </div>
        <div class="hero-media">
            <div class="hero-card hero-card--primary">
                <span class="chip">Trung tâm pin</span>
                <h3>Quy trình kiểm định đa lớp</h3>
                <p>Mỗi pin được kiểm tra 42 bước trước khi đưa vào trạm đổi, đảm bảo an toàn và dung lượng tối ưu.</p>
                <ul>
                    <li>Chuẩn IP67 chống nước</li>
                    <li>Giám sát nhiệt độ theo thời gian thực</li>
                    <li>Lưu vết lịch sử sử dụng</li>
                </ul>
            </div>
            <div class="hero-card hero-card--secondary">
                <header>
                    <strong>Pin LFP thế hệ 2025</strong>
                    <span>Tuổi thọ 2.500 chu kỳ sạc</span>
                </header>
                <div class="progress">
                    <span>Hiệu suất 98%</span>
                    <div class="progress-bar"><span style="width: 98%"></span></div>
                </div>
                <footer>
                    <p>Tích hợp hệ thống làm mát chủ động, tương thích mọi dòng xe học sinh & cao cấp.</p>
                </footer>
            </div>
        </div>
    </section>

    <section class="vf-container plan-section" id="goi-pin" data-animate>
        <header class="section-header">
            <small>Bảng giá thuê pin</small>
            <h2>Chọn gói pin phù hợp hành trình của bạn</h2>
            <p>Mọi gói đều bao gồm bảo hành trọn đời thuê, hỗ trợ đổi pin khẩn cấp và cập nhật phần mềm pin OTA.</p>
        </header>
        <div class="plan-grid">
            <article class="plan-card">
                <h3>Gói Linh hoạt</h3>
                <p class="plan-price">199.000&nbsp;VNĐ/tháng</p>
                <ul>
                    <li>Dưới 1.500 km/tháng</li>
                    <li>3 lần đổi pin/ngày</li>
                    <li>Miễn phí kiểm tra định kỳ</li>
                </ul>
                <button class="vf-btn vf-btn--ghost">Đăng ký</button>
            </article>
            <article class="plan-card plan-card--featured">
                <span class="chip chip--light">Phổ biến</span>
                <h3>Gói Không giới hạn</h3>
                <p class="plan-price">350.000&nbsp;VNĐ/tháng</p>
                <ul>
                    <li>Không giới hạn km</li>
                    <li>Đổi pin 24/7 tại mọi trạm</li>
                    <li>Thay pin miễn phí khi suy hao > 20%</li>
                </ul>
                <button class="vf-btn vf-btn--primary">Đăng ký ngay</button>
            </article>
            <article class="plan-card">
                <h3>Gói Doanh nghiệp</h3>
                <p class="plan-price">Liên hệ</p>
                <ul>
                    <li>Quản lý đội xe tập trung</li>
                    <li>Giám sát pin theo thời gian thực</li>
                    <li>Ưu đãi dịch vụ lưu động</li>
                </ul>
                <button class="vf-btn vf-btn--ghost">Nhận tư vấn</button>
            </article>
        </div>
    </section>

    <section class="vf-container benefit-section" data-animate>
        <header class="section-header">
            <small>Giá trị khác biệt</small>
            <h2>Hệ sinh thái pin toàn diện</h2>
        </header>
        <div class="benefit-grid">
            <article>
                <h3>Theo dõi từ xa</h3>
                <p>Ứng dụng VinFast App cho phép kiểm tra dung lượng, nhiệt độ và lịch sử pin mọi lúc.</p>
            </article>
            <article>
                <h3>Đổi pin trong 3 phút</h3>
                <p>Các trạm đổi tự động hóa, hỗ trợ thanh toán QR và định vị thông minh.</p>
            </article>
            <article>
                <h3>Bảo hiểm pin toàn diện</h3>
                <p>Được bồi thường pin mới khi gặp sự cố bất khả kháng trong quá trình sử dụng.</p>
            </article>
            <article>
                <h3>Cam kết môi trường</h3>
                <p>Pin sau vòng đời được tái chế chuẩn quốc tế, tuân thủ mô hình kinh tế tuần hoàn.</p>
            </article>
        </div>
    </section>

    <section class="network-section" data-animate>
        <div class="vf-container network-inner">
            <div class="network-copy">
                <small class="eyebrow">Phủ sóng toàn quốc</small>
                <h2>Hơn 6.000 trạm đổi pin hoạt động 24/7</h2>
                <p>VinFast hợp tác cùng cửa hàng tiện lợi, bãi gửi xe và đại lý để phủ sóng trạm đổi pin tại 63 tỉnh thành.</p>
                <ul>
                    <li>Định vị & đặt lịch đổi pin ngay trên VinFast App</li>
                    <li>Bản đồ thời gian thực hiển thị công suất & số pin còn lại</li>
                    <li>Tích hợp thanh toán không tiền mặt</li>
                </ul>
            </div>
            <div class="network-panel">
                <header>
                    <h3>Chỉ số hoạt động 2025</h3>
                    <span>cập nhật cuối tuần</span>
                </header>
                <dl>
                    <div>
                        <dt th:text="${totalStations != null ? totalStations : '6.248'}">6.248</dt>
                        <dd>Trạm đổi pin</dd>
                    </div>
                    <div>
                        <dt>12 phút</dt>
                        <dd>Thời gian thay pin trung bình</dd>
                    </div>
                    <div>
                        <dt>98,5%</dt>
                        <dd>Mức sẵn sàng của pin</dd>
                    </div>
                </dl>
                <button class="vf-btn vf-btn--primary" onclick="findNearestStations()">Tìm trạm gần nhất</button>
            </div>
        </div>
    </section>

    <!-- Section hiển thị danh sách trạm sạc pin gần nhất -->
    <section class="vf-container stations-section" data-animate th:if="${chargingStations != null && !chargingStations.isEmpty()}">
        <header class="section-header">
            <small>Trạm sạc pin</small>
            <h2>Trạm sạc pin gần nhất</h2>
            <p>Danh sách các trạm sạc pin đang hoạt động, sắp xếp theo khoảng cách</p>
        </header>
        <div class="stations-grid">
            <article class="station-card" th:each="station : ${chargingStations}">
                <div class="station-header">
                    <h3 th:text="${station.name}">Tên trạm</h3>
                    <span class="station-status" 
                          th:classappend="${station.status == 'ACTIVE'} ? 'status-active' : 'status-inactive'"
                          th:text="${station.status == 'ACTIVE'} ? 'Đang hoạt động' : 'Tạm ngưng'">
                        Đang hoạt động
                    </span>
                </div>
                <div class="station-info">
                    <div class="info-item">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" stroke-width="2"/>
                            <circle cx="12" cy="10" r="3" stroke-width="2"/>
                        </svg>
                        <span th:text="${station.address}">Địa chỉ</span>
                    </div>
                    <div class="info-item" th:if="${station.province != null}">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor">
                            <path d="M12 2L2 7l10 5 10-5-10-5z" stroke-width="2"/>
                            <path d="M2 17l10 5 10-5" stroke-width="2"/>
                            <path d="M2 12l10 5 10-5" stroke-width="2"/>
                        </svg>
                        <span>
                            <span th:text="${station.province}">Tỉnh/Thành phố</span>
                            <span th:if="${station.district != null && !station.district.isEmpty()}" th:text="', ' + ${station.district}"></span>
                        </span>
                    </div>
                    <div class="info-item" th:if="${station.phone != null}">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" stroke-width="2"/>
                        </svg>
                        <span th:text="${station.phone}">Số điện thoại</span>
                    </div>
                </div>
                <div class="station-stats">
                    <div class="stat-item">
                        <span class="stat-label">Pin có sẵn</span>
                        <span class="stat-value" th:text="${station.availableBatteries} + '/' + ${station.totalCapacity}">0/0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Giờ hoạt động</span>
                        <span class="stat-value" th:text="${station.operatingHours}">24/7</span>
                    </div>
                </div>
                <div class="station-actions">
                    <a th:href="@{'https://www.google.com/maps?q=' + ${station.latitude} + ',' + ${station.longitude}}" 
                       target="_blank" 
                       class="vf-btn vf-btn--ghost vf-btn--small">
                        Xem bản đồ
                    </a>
                    <button class="vf-btn vf-btn--primary vf-btn--small call-station-btn" 
                            th:data-phone="${station.phone}" 
                            th:if="${station.phone != null && !station.phone.isEmpty()}">
                        Gọi ngay
                    </button>
                </div>
            </article>
        </div>
    </section>

    <section class="vf-container flow-section" data-animate>
        <header class="section-header">
            <small>Quy trình đăng ký</small>
            <h2>3 bước đơn giản sở hữu gói pin</h2>
        </header>
        <ol class="flow-steps">
            <li>
                <h3>Bước 1: Chọn gói</h3>
                <p>Đăng nhập VinFast App hoặc đến showroom để chọn gói thuê phù hợp.</p>
            </li>
            <li>
                <h3>Bước 2: Ký hợp đồng điện tử</h3>
                <p>Ký số trong 2 phút, thanh toán trực tuyến hoặc trả góp qua ngân hàng liên kết.</p>
            </li>
            <li>
                <h3>Bước 3: Kích hoạt & nhận pin</h3>
                <p>Nhận mã kích hoạt, đổi pin tại trạm gần nhất hoặc được giao tận nơi.</p>
            </li>
        </ol>
    </section>

    <section class="vf-container faq-section" data-animate>
        <header class="section-header">
            <small>Giải đáp</small>
            <h2>Câu hỏi thường gặp</h2>
        </header>
        <div class="faq-grid">
            <article>
                <h3>Pin thuê có khác pin mua?</h3>
                <p>Pin thuê luôn được VinFast bảo dưỡng và thay thế khi dung lượng giảm dưới 80% so với ban đầu.</p>
            </article>
            <article>
                <h3>Tôi có thể đổi gói giữa chừng?</h3>
                <p>Hoàn toàn có thể sau mỗi chu kỳ 30 ngày, không mất phí chuyển đổi.</p>
            </article>
            <article>
                <h3>Nếu đi tỉnh chưa có trạm thì sao?</h3>
                <p>Đội xe dịch vụ lưu động sẽ giao pin dự phòng trong vòng 2 giờ tại khu vực chưa có trạm cố định.</p>
            </article>
            <article>
                <h3>Làm sao theo dõi tình trạng pin?</h3>
                <p>Ứng dụng VinFast App cập nhật dữ liệu pin theo thời gian thực và cảnh báo khi cần đổi.</p>
            </article>
        </div>
    </section>

    <section class="vf-container cta-section" data-animate>
        <div>
            <p class="eyebrow">Cần thêm thông tin?</p>
            <h2>Kết nối chuyên gia năng lượng VinFast</h2>
            <p>Đăng ký để nhận tư vấn về gói pin, kế hoạch chuyển đổi xe điện doanh nghiệp và ưu đãi mới nhất.</p>
        </div>
        <div class="cta-actions">
            <button class="vf-btn vf-btn--primary">Đặt lịch tư vấn</button>
            <a class="vf-btn vf-btn--ghost" href="https://vinfastauto.com/vn_vi/dich-vu/pin" target="_blank" rel="noreferrer">Tìm hiểu thêm</a>
        </div>
    </section>
</main>

<div th:replace="~{fragments/chan-trang :: chanTrang}"></div>

<script th:src="@{/js/dieu-huong.js}" src="/js/dieu-huong.js"></script>
<script>
    (function () {
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                }
            });
        }, { threshold: 0.2 });

        document.querySelectorAll('[data-animate]').forEach(el => observer.observe(el));
    })();

    // Hàm tìm trạm gần nhất dựa trên vị trí hiện tại
    function findNearestStations() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    window.location.href = '/dich-vu-pin?lat=' + lat + '&lng=' + lng;
                },
                function(error) {
                    alert('Không thể lấy vị trí của bạn. Vui lòng cho phép truy cập vị trí hoặc tìm kiếm thủ công.');
                    // Nếu không lấy được vị trí, hiển thị tất cả trạm
                    window.location.href = '/dich-vu-pin';
                }
            );
        } else {
            alert('Trình duyệt của bạn không hỗ trợ định vị. Vui lòng sử dụng trình duyệt khác.');
            window.location.href = '/dich-vu-pin';
        }
    }

    // Hàm gọi điện đến trạm
    function callStation(phone) {
        if (phone) {
            window.location.href = 'tel:' + phone;
        }
    }

    // Thêm event listener cho các nút gọi điện
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.call-station-btn').forEach(function(button) {
            button.addEventListener('click', function() {
                const phone = this.getAttribute('data-phone');
                if (phone) {
                    callStation(phone);
                }
            });
        });
    });
</script>
</body>
</html>
