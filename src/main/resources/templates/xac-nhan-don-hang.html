<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>X√°c nh·∫≠n ƒë∆°n h√†ng - VinFast</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/trang-chu.css}" href="/css/trang-chu.css">
    <style>
        .confirmation-page {
            padding: 40px 0;
            background: linear-gradient(180deg, #f7f9ff 0%, #ffffff 60%, #f1f4fb 100%);
            min-height: calc(100vh - 200px);
        }
        
        .confirmation-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .confirmation-card {
            background: white;
            border-radius: 16px;
            padding: 48px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            text-align: center;
            margin-bottom: 32px;
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 24px;
            background: #00a86b;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: white;
        }
        
        .confirmation-card h1 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #1a1a1a;
        }
        
        .confirmation-card p {
            font-size: 18px;
            color: #666;
            margin-bottom: 24px;
        }
        
        .order-code {
            font-size: 24px;
            font-weight: 700;
            color: #0048ff;
            padding: 16px 32px;
            background: #f0f7ff;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 32px;
        }
        
        .order-details-card {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 24px;
        }
        
        .order-details-card h2 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 24px;
            color: #1a1a1a;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 12px;
        }
        
        .detail-section {
            margin-bottom: 32px;
        }
        
        .detail-section:last-child {
            margin-bottom: 0;
        }
        
        .detail-section h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #333;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .detail-label {
            color: #666;
            font-size: 14px;
        }
        
        .detail-value {
            color: #1a1a1a;
            font-weight: 600;
            font-size: 14px;
            text-align: right;
        }
        
        .order-items {
            margin-top: 16px;
        }
        
        .order-item {
            display: flex;
            gap: 16px;
            padding: 16px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .order-item:last-child {
            border-bottom: none;
        }
        
        .order-item-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
        }
        
        .order-item-info {
            flex: 1;
            text-align: left;
        }
        
        .order-item-info h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
            color: #1a1a1a;
        }
        
        .order-item-info p {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .order-item-price {
            font-size: 16px;
            font-weight: 700;
            color: #0048ff;
            min-width: 120px;
            text-align: right;
        }
        
        .summary-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 24px;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 14px;
        }
        
        .summary-row:last-child {
            margin-bottom: 0;
            padding-top: 12px;
            border-top: 2px solid #e0e0e0;
            font-size: 18px;
            font-weight: 700;
            color: #0048ff;
        }
        
        .action-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-top: 32px;
        }
        
        .btn {
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: all 0.2s;
            border: none;
        }
        
        .btn-primary {
            background: #0048ff;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0038cc;
        }
        
        .btn-outline {
            background: white;
            color: #0048ff;
            border: 2px solid #0048ff;
        }
        
        .btn-outline:hover {
            background: #f0f7ff;
        }
        
        .payment-note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 16px;
            border-radius: 8px;
            margin-top: 24px;
            text-align: left;
        }
        
        .payment-note h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #856404;
        }
        
        .payment-note p {
            font-size: 14px;
            color: #856404;
            margin: 0;
        }
        
        @media (max-width: 768px) {
            .confirmation-card {
                padding: 32px 24px;
            }
            
            .order-details-card {
                padding: 24px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>

<div th:replace="~{fragments/dieu-huong :: thanhDieuHuong}"></div>

<main class="confirmation-page">
    <div class="confirmation-container">
        <!-- Th√¥ng b√°o th√†nh c√¥ng -->
        <div class="confirmation-card" th:if="${order != null}">
            <div class="success-icon">‚úì</div>
            <h1>ƒê·∫∑t h√†ng th√†nh c√¥ng!</h1>
            <p>C·∫£m ∆°n b·∫°n ƒë√£ ƒë·∫∑t h√†ng. ƒê∆°n h√†ng c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c x√°c nh·∫≠n.</p>
            <div class="order-code" th:text="${order.orderCode}">VF1234567890</div>
            <p style="font-size: 14px; color: #888;">
                Ch√∫ng t√¥i ƒë√£ g·ª≠i email x√°c nh·∫≠n ƒë·∫øn ƒë·ªãa ch·ªâ email c·ªßa b·∫°n.
            </p>
        </div>
        
        <!-- Chi ti·∫øt ƒë∆°n h√†ng -->
        <div class="order-details-card" th:if="${order != null}">
            <h2>Th√¥ng tin ƒë∆°n h√†ng</h2>
            
            <!-- Th√¥ng tin giao h√†ng -->
            <div class="detail-section">
                <h3>Th√¥ng tin giao h√†ng</h3>
                <div class="detail-row">
                    <span class="detail-label">Ng∆∞·ªùi nh·∫≠n</span>
                    <span class="detail-value" th:text="${order.address.fullName}">Nguy·ªÖn VƒÉn A</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">S·ªë ƒëi·ªán tho·∫°i</span>
                    <span class="detail-value" th:text="${order.address.phone}">0901234567</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">ƒê·ªãa ch·ªâ giao h√†ng</span>
                    <span class="detail-value" th:text="${order.address.fullAddress}">ƒê·ªãa ch·ªâ</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Ph∆∞∆°ng th·ª©c v·∫≠n chuy·ªÉn</span>
                    <span class="detail-value" 
                          th:text="${order.deliveryMethod == T(com.example.asmproject.model.Order.DeliveryMethod).FAST} ? 'Giao nhanh h·ªèa t·ªëc (24h)' : 'Ti√™u chu·∫©n (3-5 ng√†y)'">
                        Ti√™u chu·∫©n
                    </span>
                </div>
            </div>
            
            <!-- S·∫£n ph·∫©m -->
            <div class="detail-section">
                <h3>S·∫£n ph·∫©m ƒë√£ ƒë·∫∑t</h3>
                <div class="order-items">
                    <div class="order-item" th:each="item : ${order.orderItems}">
                        <img th:src="${item.productImage != null and !item.productImage.isEmpty()} ? 
                                   (${item.productImage.startsWith('/')} ? @{${item.productImage}} : @{/image/{img}(img=${item.productImage})}) 
                                   : @{/image/evo200.jpg}" 
                             src="/image/evo200.jpg" 
                             th:alt="${item.productName}"
                             class="order-item-image">
                        <div class="order-item-info">
                            <h4 th:text="${item.productName}">T√™n s·∫£n ph·∫©m</h4>
                            <p th:if="${item.colorName != null}" th:text="'M√†u: ' + ${item.colorName}">M√†u</p>
                            <p th:text="'S·ªë l∆∞·ª£ng: ' + ${item.quantity}">S·ªë l∆∞·ª£ng: 1</p>
                        </div>
                        <div class="order-item-price" 
                             th:text="${#numbers.formatDecimal(item.price * item.quantity, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">
                            0 ‚Ç´
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- T·ªïng ti·ªÅn -->
            <div class="summary-section">
                <div class="summary-row">
                    <span>T·∫°m t√≠nh</span>
                    <strong th:text="${#numbers.formatDecimal(order.subtotal, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">0 ‚Ç´</strong>
                </div>
                <div class="summary-row" th:if="${order.shippingFee != null and order.shippingFee > 0}">
                    <span>Ph√≠ v·∫≠n chuy·ªÉn</span>
                    <strong th:text="${#numbers.formatDecimal(order.shippingFee, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">0 ‚Ç´</strong>
                </div>
                <div class="summary-row" th:if="${order.discount != null and order.discount > 0}">
                    <span>Gi·∫£m gi√°</span>
                    <strong th:text="'- ' + ${#numbers.formatDecimal(order.discount, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">- 0 ‚Ç´</strong>
                </div>
                <div class="summary-row">
                    <span>T·ªïng c·ªông</span>
                    <strong th:text="${#numbers.formatDecimal(order.total, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">0 ‚Ç´</strong>
                </div>
            </div>
            
            <!-- Ghi ch√∫ thanh to√°n -->
            <div class="payment-note" th:if="${order.paymentMethod == 'SHOWROOM'}">
                <h4>üí≥ Thanh to√°n t·∫°i showroom</h4>
                <p>B·∫°n s·∫Ω thanh to√°n tr·ª±c ti·∫øp t·∫°i showroom khi nh·∫≠n h√†ng. Vui l√≤ng mang theo CMND/CCCD ƒë·ªÉ ƒë·ªëi chi·∫øu.</p>
            </div>
            <div class="payment-note" th:if="${order.paymentMethod == 'BANK_TRANSFER'}">
                <h4>üè¶ Chuy·ªÉn kho·∫£n ng√¢n h√†ng</h4>
                <p>Vui l√≤ng chuy·ªÉn kho·∫£n s·ªë ti·ªÅn <strong th:text="${#numbers.formatDecimal(order.total, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></strong> v√†o t√†i kho·∫£n ng√¢n h√†ng c·ªßa ch√∫ng t√¥i. Th√¥ng tin chuy·ªÉn kho·∫£n ƒë√£ ƒë∆∞·ª£c g·ª≠i qua email.</p>
            </div>
            <div class="payment-note" th:if="${order.paymentMethod == 'CREDIT_CARD'}">
                <h4>üí≥ Th·∫ª t√≠n d·ª•ng / Ghi n·ª£</h4>
                <p>Thanh to√°n s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω trong v√≤ng 24 gi·ªù. B·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c email x√°c nh·∫≠n khi thanh to√°n th√†nh c√¥ng.</p>
            </div>
            
            <!-- Th√¥ng tin ƒë∆°n h√†ng kh√°c -->
            <div class="detail-section" style="margin-top: 24px;">
                <div class="detail-row">
                    <span class="detail-label">Tr·∫°ng th√°i ƒë∆°n h√†ng</span>
                    <span class="detail-value" 
                          th:switch="${order.orderStatus}">
                        <span th:case="'PENDING'">ƒêang ch·ªù x√°c nh·∫≠n</span>
                        <span th:case="'CONFIRMED'">ƒê√£ x√°c nh·∫≠n</span>
                        <span th:case="'PROCESSING'">ƒêang x·ª≠ l√Ω</span>
                        <span th:case="'SHIPPING'">ƒêang giao h√†ng</span>
                        <span th:case="'DELIVERED'">ƒê√£ giao h√†ng</span>
                        <span th:case="'CANCELLED'">ƒê√£ h·ªßy</span>
                        <span th:case="'RETURNED'">ƒê√£ tr·∫£ h√†ng</span>
                        <span th:case="*" th:text="${order.orderStatus}">Tr·∫°ng th√°i</span>
                    </span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Ng√†y ƒë·∫∑t h√†ng</span>
                    <span class="detail-value" th:text="${#temporals.format(order.createdAt, 'dd/MM/yyyy HH:mm')}">01/01/2024 10:00</span>
                </div>
            </div>
        </div>
        
        <!-- Th√¥ng b√°o l·ªói n·∫øu kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng -->
        <div class="confirmation-card" th:if="${order == null}">
            <div style="font-size: 48px; margin-bottom: 24px;">‚ö†Ô∏è</div>
            <h1>Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng</h1>
            <p>ƒê∆°n h√†ng b·∫°n ƒëang t√¨m kh√¥ng t·ªìn t·∫°i ho·∫∑c b·∫°n kh√¥ng c√≥ quy·ªÅn xem ƒë∆°n h√†ng n√†y.</p>
            <div class="action-buttons">
                <a href="/" class="btn btn-primary">V·ªÅ trang ch·ªß</a>
                <a href="/tai-khoan" class="btn btn-outline">T√†i kho·∫£n c·ªßa t√¥i</a>
            </div>
        </div>
        
        <!-- N√∫t h√†nh ƒë·ªông -->
        <div class="action-buttons" th:if="${order != null}">
            <a href="/" class="btn btn-primary">Ti·∫øp t·ª•c mua s·∫Øm</a>
            <a th:href="@{'/tai-khoan?tab=orders'}" class="btn btn-outline">Xem ƒë∆°n h√†ng c·ªßa t√¥i</a>
        </div>
    </div>
</main>

<div th:replace="~{fragments/chan-trang :: chanTrang}"></div>

<script th:src="@{/js/dieu-huong.js}" src="/js/dieu-huong.js"></script>
</body>
</html>

