<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>VinFast Admin | Quản lý đơn hàng</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/admin.css}" href="/css/admin.css">
</head>

<body class="admin-body">
    <div class="admin-shell">
        <div th:replace="~{admin/fragments/sidebar :: sidebar(${adminSection})}"></div>

        <div class="admin-main">
            <header class="admin-topbar">
                <div>
                    <p class="eyebrow">Kinh doanh</p>
                    <h1>Đơn hàng</h1>
                </div>
                <div class="admin-topbar__actions">
                    <button class="adm-btn adm-btn--ghost">Xuất báo cáo</button>
                </div>
            </header>

            <section class="admin-content">
                <div class="filter-bar">
                    <div class="filter-group">
                        <span>Trạng thái:</span>
                        <a th:href="@{/admin/don-hang(keyword=${keyword})}" class="chip"
                            th:classappend="${currentStatus == null} ? 'is-active'">Tất cả</a>

                        <form th:action="@{/admin/don-hang}" method="get" class="search-form">
                            <input type="hidden" name="status" th:if="${currentStatus != null}" <!DOCTYPE html>
                            <html lang="vi" xmlns:th="http://www.thymeleaf.org">

                            <head>
                                <meta charset="UTF-8">
                                <meta name="viewport" content="width=device-width, initial-scale=1">
                                <title>VinFast Admin | Quản lý đơn hàng</title>
                                <link rel="preconnect" href="https://fonts.googleapis.com">
                                <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
                                <link
                                    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
                                    rel="stylesheet">
                                <link rel="stylesheet" th:href="@{/css/admin.css}" href="/css/admin.css">
                            </head>

                            <body class="admin-body">
                                <div class="admin-shell">
                                    <div th:replace="~{admin/fragments/sidebar :: sidebar(${adminSection})}"></div>

                                    <div class="admin-main">
                                        <header class="admin-topbar">
                                            <div>
                                                <p class="eyebrow">Kinh doanh</p>
                                                <h1>Đơn hàng</h1>
                                            </div>
                                            <div class="admin-topbar__actions">
                                                <button class="adm-btn adm-btn--ghost">Xuất báo cáo</button>
                                            </div>
                                        </header>

                                        <section class="admin-content">
                                            <div class="filter-bar">
                                                <div class="filter-group">
                                                    <span>Trạng thái:</span>
                                                    <a th:href="@{/admin/don-hang(keyword=${keyword})}" class="chip"
                                                        th:classappend="${currentStatus == null} ? 'is-active'">Tất
                                                        cả</a>

                                                    <form th:action="@{/admin/don-hang}" method="get"
                                                        class="search-form">
                                                        <input type="hidden" name="status"
                                                            th:if="${currentStatus != null}"
                                                            th:value="${currentStatus}">
                                                        <input type="search" name="keyword" th:value="${keyword}"
                                                            placeholder="Tìm theo mã đơn hàng, SĐT...">
                                                    </form>
                                                </div>

                                                <div class="admin-card">
                                                    <header>
                                                        <h2>Danh sách đơn hàng</h2>
                                                    </header>
                                                    <div class="table-scroll">
                                                        <table>
                                                            <thead>
                                                                <tr>
                                                                    <th>Mã Đơn</th>
                                                                    <th>Khách hàng</th>
                                                                    <th>Ngày đặt</th>
                                                                    <th>Tổng tiền</th>
                                                                    <th>Thanh toán</th>
                                                                    <th>Trạng thái ĐH</th>
                                                                    <th>Thao tác</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr th:each="order : ${orders.content}">
                                                                    <td><strong
                                                                            th:text="${order.orderCode}">#ORD-001</strong>
                                                                    </td>
                                                                    <td>
                                                                        <div th:text="${order.address.fullName}">Nguyễn
                                                                            Văn A</div>
                                                                        <small style="color: #6b748b;"
                                                                            th:text="${order.address.phone}">0901234567</small>
                                                                    </td>
                                                                    <td
                                                                        th:text="${#temporals.format(order.createdAt, 'dd/MM/yyyy HH:mm')}">
                                                                        01/01/2024</td>
                                                                    <td style="font-weight: 600; color: #0056ff;"
                                                                        th:text="${#numbers.formatDecimal(order.total, 0, 'COMMA', 0, 'POINT')} + ' ₫'">
                                                                        10.000.000 ₫</td>
                                                                    <td>
                                                                        <span class="badge"
                                                                            th:classappend="${order.paymentStatus == T(com.example.asmproject.model.Order.PaymentStatus).PAID ? 'badge--success' : 'badge--warning'}"
                                                                            th:text="${order.paymentStatus}">PAID</span>
                                                                    </td>
                                                                    <td>
                                                                        <span class="badge"
                                                                            th:classappend="${order.orderStatus == T(com.example.asmproject.model.Order.OrderStatus).DELIVERED ? 'badge--success' : 
                                                                (order.orderStatus == T(com.example.asmproject.model.Order.OrderStatus).CANCELLED ? 'badge--danger' : 'badge--info')}"
                                                                            th:text="${order.orderStatus}">PENDING</span>
                                                                    </td>
                                                                    <td>
                                                                        <a th:href="@{/admin/don-hang/{id}(id=${order.id})}"
                                                                            class="adm-btn adm-btn--sm">Chi tiết</a>
                                                                    </td>
                                                                </tr>
                                                                <tr th:if="${orders.empty}">
                                                                    <td colspan="7"
                                                                        style="text-align: center; padding: 20px;">Không
                                                                        tìm thấy đơn hàng nào</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>

                                                    <!-- Pagination -->
                                                    <div class="pagination" th:if="${orders.totalPages > 1}"
                                                        style="padding: 16px; display: flex; justify-content: center; gap: 8px;">
                                                        <a th:if="${orders.hasPrevious()}"
                                                            th:href="@{/admin/don-hang(page=${orders.number - 1}, keyword=${keyword}, status=${currentStatus})}"
                                                            class="adm-btn adm-btn--ghost">&laquo; Trước</a>

                                                        <span style="display: flex; align-items: center;">
                                                            Trang <span th:text="${orders.number + 1}"
                                                                style="margin: 0 4px; font-weight: bold;">1</span> /
                                                            <span th:text="${orders.totalPages}"
                                                                style="margin-left: 4px;">5</span>
                                                        </span>

                                                        <a th:if="${orders.hasNext()}"
                                                            th:href="@{/admin/don-hang(page=${orders.number + 1}, keyword=${keyword}, status=${currentStatus})}"
                                                            class="adm-btn adm-btn--ghost">Sau &raquo;</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </section>
                                    </div>
                                </div>
                            </body>

                            </html>